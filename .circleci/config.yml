version: 2.1
parameters:
  vmanage_host:
    type: string
    default: ""
  vmanage_user:
    type: string
    default: ""
  vmanage_pass:
    type: string
    default: ""
orbs:
  newman: oshafran/oshafran-pied-piper-orb@dev:alpha
jobs:
  "Checkout":
    resource_class: "small"
    docker:
      - image: alpine:latest
    steps:
      - checkout
      - persist_to_workspace:
          root: /root/project
          paths:
            - ./*
workflows:
  default-pipeline:
    jobs:
      - "Checkout"
      - newman/pipeline:
          dir: /root/project/collections
          openapiDir: /root/project/openapi
          vManageIP: << pipeline.parameters.vmanage_host >>
          vManageUser: << pipeline.parameters.vmanage_user >>
          vManagePwd: << pipeline.parameters.vmanage_pass >>
          requires: 
            - "Checkout"
